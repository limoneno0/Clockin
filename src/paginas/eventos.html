<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agenda</title>
    <link rel="stylesheet" href="../css/dashboard.css">
</head>
<body>
    <div class="container">
    <section id="formev" class="iframe-form">
        <form action="agenda2.html">
            <input type="text" name="titulo" id="titulo" placeholder="Título do evento" aria-placeholder="Título do evento">
            <label for="inicioev">Início:</label>
            <input type="datetime-local" name="inicioev" id="inicioev">
            <label for="fimev">Fim:</label>
            <input type="datetime-local" name="fimev" id="fimev">
            <input type="text" name="localev" id="localev" placeholder="Local do evento" aria-placeholder="Local do evento">
            <textarea name="descricao" id="descricao" placeholder="Descrição do evento" aria-placeholder="Descrição do evento"></textarea>
            <input type="submit" value="Criar evento">
        </form>
    </section>
    <section id="ag">
        <button id="botao" class="iframe-button">Criar Evento</button>
        <div class="iframe-card">
            <p id="titulodin"></p>
            <p id="iniciodin"></p>
            <button id="urlref1" class="iframe-button">Agendar</button>
        </div>

        <div class="iframe-card">
            <p>Aniversário - João Silva</p>
            <p class="legenda">24/01</p>
            <span id="urlref2" class="iframe-categ">Aniversário</span>
        </div>
        <div class="iframe-card">
            <p>Fim do periodo de experiência</p>
            <p class="legenda">25/01</p>
            <span id="urlref3" class="iframe-categ">Experiência</span>
        </div>
        <div class="iframe-card">
            <p>Fechamento da folha</p>
            <p class="legenda">28/01</p>
            <span id="urlref4" class="iframe-categ">Folha de pagamento</span>
        </div>


    </section>
    </div>
</body>
<script>
    document.addEventListener('DOMContentLoaded', function() {
    const urlParams = new URLSearchParams(window.location.search);
    
    const formev = document.getElementById('formev')
    const botao = document.getElementById('botao')
    const linkref1 = document.getElementById('urlref1')
    const linkref2 = document.getElementById('urlref2')
    const linkref3 = document.getElementById('urlref3')
    const linkref4 = document.getElementById('urlref4')
    const ag = document.getElementById('ag')
    

    let titulo = urlParams.get('titulo')
    let inicioev = urlParams.get('inicioev');
    let fimev = urlParams.get('fimev')
    let localev = urlParams.get('localev')
    let descricao = urlParams.get('descricao')
    
    function toUTC(dateString) {
    if (!dateString) return '';

    const date = new Date(dateString);

    if (isNaN(date.getTime())) return '';
    return date.toISOString().replace(/[-:]/g, '').split('.')[0] + 'Z';
}


    const urlgooglecal = `https://calendar.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(titulo || 'Evento')}&dates=${toUTC(inicioev)}/${toUTC(fimev)}&details=${encodeURIComponent(descricao || '')}`




    inicioev = Date.parse(inicioev)
    const data = new Date(parseInt(inicioev))
    const mes = String(data.getMonth() + 1).padStart(2, '0')
    const dia = String(data.getDate()).padStart(2, '0');
    const inicio = dia + '/' + mes;
        document.getElementById('titulodin').innerHTML = titulo;
        document.getElementById('iniciodin').innerHTML = inicio;

    botao.addEventListener('click', () => {
        formev.style.display = 'block';
        ag.style.display = 'none';
    })
    linkref1.addEventListener('click', () => {
        window.open(urlgooglecal, '_blank')
    });
});

</script>
</html>
